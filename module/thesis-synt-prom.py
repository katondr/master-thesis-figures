#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Jul 29 12:53:54 2021

@author: tony
"""
#%%
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import scipy.optimize as opt
import copy
from matplotlib.ticker import ScalarFormatter
from dna_features_viewer import GraphicFeature, GraphicRecord
plt.rcParams["font.family"] = "serif"
plt.rcParams["font.sans-serif"] = "Times New Roman"
plt.rcParams['font.size'] = "9"
#%%
sequence_1 = "GTCGACCTTCCTGGTTCAGAGCCTCATATCCATATTACGACCACTTCAATGGGCGATCAAAAAGTACATTACATGATTTTTTGCCCAACAGAAAAAGCCTCTCATTTAGAGCAGCTTATTCGTCAAGATTTCATGGAAATGTATGAGATCAATTTTCCACAAAAAACAGAGTAACAAAGAGAAAAACCTATAGGTATAAAGCTTTACTTACGTACTTAATTTTTAAAGTATGGGCAATCAATTGCTCCTGTTAAAATTGCTTTAGAAATACTTTGGCAGCGGTTTGTTGTATTGAGTTTCATTTGCGCATTGGTTAAATGGAAAGTGACAGTACGCTCACTGCAGCCTAATATTTTTGAAATATCCCAAGAGCTTTTTCCTTCGCATGCCCACGCTAAACATTCTTTTTCTCTTTTGGTTAAATCGTTGTTTGATTTATTATTTGCTATATTTATTTTTCGATAATTATCAACTAGAGAAGGAACAATTAATGGTATGTTCATACACGCATGTAAAAATAAACTATCTATATAGTTGTCTTTTTCTGAATGTGCAAAACTAAGCATTCCGAAGCCATTGTTAGCCGTATGAATAGGGAAACTAAACCCAGTGATAAGACCTGATGTTTTCGCTTCTTTAATTACATTTGGAGATTTTTTATTTACAGCATTGTTTTCAAATATATTCCAATTAATTGGTGAATGATTGGAGTTAGAATAATCTACTATAGGATCATATTTTATTAAATTAGCGTCATCATAATATTGCCTCCATTTTTTAGGGTAATTATCTAGAATTGAAATATCAGATTTAACCATAGAATGAGGATAAATGATCGCGAGTAAATAATATTCACAATGTACCATTTTAGTCATATCAGATAAGCATTGATTAATATCATTATTGCTTCTACAAGCTTTAATTTTATTAATTATTCTGTATGTGTCGTCGGCATTTATGTTTTTCATACCCATCTCTTTATCCTTACCTATTGTTTGTCGCAAGTTTTGCGTGTTATATATCATTAAAACGGTAATGGATTGACATTTGATTCTAATAAATTGGATTTTTGTCACACTATTGTATCGCTGGGAATACAATTACTTAACATAAGCACCTGTAGGATCGTACAGGTTTACGCAAGAAAATGGTTTGTTATAGTCGAATAAACGCAAGGGAGGTTGGTATGACTATAATGATAAAAAAATCGGATTTTTTGGCAATTCCATCGGAGGAGTATAAAGGTATTCTAAGTCTTCGTTATCAAGTGTTTAAGCAAAGACTTGAGTGGGACTTAGTTGTAGAAAATAACCTTGAATCAGATGAGTATGATAACTCAAATGCAGAATATATTTATGCTTGTGATGATACTGAAAATGTAAGTGGATGCTGGCGTTTATTACCTACAACAGGTGATTATATGCTGAAAAGTGTTTTTCCTGAATTGCTTGGTCAACAGAGTGCTCCCAAAGATCCTAATATAGTCGAATTAAGTCGTTTTGCTGTAGGTAAAAATAGCTCAAAGATAAATAACTCTGCTAGTGAAATTACAATGAAACTATTTGAAGCTATATATAAACACGCTGTTAGTCAAGGTATTACAGAATATGTAACAGTAACATCAACAGCAATAGAGCGATTTTTAAAGCGTATTAAAGTTCCTTGTCATCGTATTGGAGACAAAGAAATTCATGTATTAGGTGATACTAAATCGGTTGTATTGTCTATGCCTATTAATGAACAGTTTAAAAAAGCAGTCTTAAATTAATGTTGTTAAATCATTAATTTATTTTAAATACTAAGTATATTATAGGGAAAATAATGAATAAATGTATTCCAATGATAATTAATGGAATGATTCAAGATTTTGATAATTATGCATATAAAGAAGTTAAACTAAATAATGATAATAGAGTAAAATTATCTGTCATTACTGAAAGTTCAGTTTCAAAAACATTAAATATCAAAGATAGAATTAATCTAAATTTAAATCAGATTGTGAATTTTTTATATACCGTTGGTCAACGATGGAAAAGTGAAGAATATAATCGGCGACGAACCTATATCCGTGAGTTAAAAACATATCTTGGTTATTCTGATGAAATGGCAAGATTAGAAGCGAATTGGATTGCAATGTTATTGTGCTCTAAAAGTGCTTTGTATGACATTGTTAATTATGATTTGGGCTCTATACACGTATTAGATGAATGGCTTCCACGTGGTGATTGCTATGTTAAAGCACAACCGAAAGGTGTTTCTGTTCACTTGTTAGCTGGTAATGTTCCATTATCAGGAGTGACATCTATTTTGCGTGCTATTTTAACAAAAAATGAGTGCATTATTAAAACTTCGTCTTCAGATCCTTTTACTGCAAACGCTTTAGTTTCCAGTTTTATTGATGTTAATGCAGACCATCCAATAACCAAATCAATGTCTGTTATGTATTGGCCGCATGATGAAGATATGACTCTATCTCAAAGAATAATGAATCATGCCGACGTGGTTATTGCTTGGGGTGGAGACGAGGCGATTAAATGGGCGGTAAAATATTCACCACCGCATGTCGATATTCTGAAATTTGGACCAAAGAAAAGCTTAAGTATTATTGAAGCTCCTAAAGATATAGAAGCCGCAGCAATGGGGGTTGCTCATGATATTTGTTTCTATGACCAGCAAGCCTGCTTCTCTACTCAAGACGTTTATTATATAGGAGATAATTTACCTTTATTTTTAAATGAACTTGAAAAACAGCTAGATCGATACGCGAAAATTTTACCAAAAGGTTCAAATAGTTTTGATGAAAAAGCGGCGTTTACTCTTACTGAAAAAGAAAGTCTATTTGCTGGATATGAAGTGAGAAAGGGAGATAAGCAAGCTTGGTTAATAGTCGTATCACCTACAAATAGCTTTGGAAATCAACCGCTATCACGAAGTGTGTATGTTCATCAAGTATCTGATATTAAAGAGATAATTCCTTTTGTTAATAAAAATAGAACACAAACTGTTTCTATTTATCCTTGGGAAGCGTCATTAAAATATCGAGATAAATTAGCAAGAAGTGGAGTTGAAAGAATTGTTGAATCAGGCATGAATAATATTTTCAGAGTTGGAGGGGCTCATGATTCATTATCTCCTCTCCAGTACCTAGTTAGGTTTGTATCGCATGAGAGACCATTTAATTATACGACAAAAGATGTTGCGGTTGAAATCGAACAAACACGTTACTTAGAGGAAGATAAGTTTTTAGTTTTTGTCCCATAGTTAAAGGAAATTATATGAAAGATGAAAGTGCTTTTTTTACGATTGATCACATCATCAAGCTTGATAATGGTCAGTCTATCCGAGTTTGGGAAACACTCCCTAAAAAGAACGTACCAGAGAAAAAACATACAATACTTATTGCTTCGGGTTTTGCTAGAAGAATGGATCATTTTGCAGGTCTTGCTGAGTATTTATCTACTAACGGTTTTCATGTCATTCGCTACGATTCTTTGCATCATGTTGGATTAAGCAGTGGATGTATAAATGAATTTACGATGTCGATTGGAAAAAATAGCCTGCTTACAGTCGTAGATTGGCTTACAGATCATGGTGTCGAACGAATAGGGCTGATTGCTGCTAGTTTGTCAGCGAGAATCGCCTATGAGGTAGTAAATAAAATTAAATTATCATTTTTAATTACGGCCGTAGGTGTCGTTAATCTTAGAGATACATTAGAAAAAGCATTGGAGTATGACTATTTGCAATTACCTATTTCAGAGTTACCAGAAGATCTTGACTTTGAAGGTCATAATTTAGGATCGGAGGTCTTTGTTACAGATTGCTTTAAACATAATTGGGACACGTTAGACTCGACACTTAATAGTGTTAAAGGATTAGCGATTCCATTTATTGCTTTTACTGCAAACGATGATAGTTGGGTAAAGCAAAGTGAAGTTATAGAGCTCATTGATAGCATTGAATCTAGTAATTGTAAGCTCTATTCGCTAATTGGAAGTTCACATGATCTTGGGGAAAATTTGGTTGTATTAAGAAATTTTTATCAATCAGTGACGAAGGCAGCCTTAGCATTAGATGATGGTTTATTGGATTTAGAGATAGACATTATTGAACCTCGATTTGAGGACGTTACAAGTATTACTGTTAAGGAGCGTAGATTAAAAAATGAAATTGAAAATGAATTATTAGAATTGGCTTAAATAAACAGAATCACCAAAAAGGAATAGAGTATGAAGTTTGGAAATATTTGTTTTTCGTATCAACCACCAGGTGAAACTCATAAGCAAGTAATGGATCGCTTTGTTCGGCTTGGTATCGCCTCAGAAGAGGTAGGGTTTGATACATATTGGACCTTAGAACATCATTTTACAGAGTTTGGTCTTACGGGAAATTTATTTGTTGCTGCGGCTAACCTGTTAGGAAGAACTAAAACATTAAATGTTGGCACTATGGGGGTTGTTATTCCGACAGCACACCCAGTTCGACAGTTAGAAGACGTTTTATTATTAGATCAAATGTCGAAAGGTCGTTTTAATTTTGGAACCGTTCGAGGGCTATACCATAAAGATTTTCGAGTATTTGGTGTTGATATGGAAGAGTCTCGAGCAATTACTCAAAATTTCTACCAGATGATAATGGAAAGCTTACAGACAGGAACCATTAGCTCTGATAGTGATTACATTCAATTTCCTAAGGTTGATGTATATCCCAAAGTGTACTCAAAAAATGTACCAACCTGTATGACTGCTGAGTCCGCAAGTACGACAGAATGGCTAGCAATACAAGGGCTACCAATGGTTCTTAGTTGGATTATTGGTACTAATGAAAAAAAAGCACAGATGGAACTCTATAATGAAATTGCGACAGAATATGGTCATGATATATCTAAAATAGATCATTGTATGACTTATATTTGTTCTGTTGATGATGATGCACAAAAGGCGCAAGATGTTTGTCGGGAGTTTCTGAAAAATTGGTATGACTCATATGTAAATGCGACCAATATCTTTAATGATAGCAATCAAACTCGTGGTTATGATTATCATAAAGGTCAATGGCGTGATTTTGTTTTACAAGGACATACAAACACCAATCGACGTGTTGATTATAGCAATGGTATTAACCCTGTAGGCACTCCTGAGCAGTGTATTGAAATCATTCAACGTGATATTGATGCAACGGGTATTACAAACATTACATGCGGATTTGAAGCTAATGGAACTGAAGATGAAATAATTGCTTCCATGCGACGCTTTATGACACAAGTCGCTCCTTTCTTAAAAGAACCTAAATAAATTACTTATTTGATACTAGAGATAATAAGGAACAAGTTATGAAATTTGGATTATTTTTTCTAAACTTTCAGAAAGATGGAATAACATCTGAAGAAACGTTGGATAATATGGTAAAGACTGTCACGTTAATTGATTCAACTAAATATCATTTTAATACTGCCTTTGTTAATGAACATCACTTTTCAAAAAATGGTATTGTTGGAGCACCTATTACCGCAGCTGGTTTTTTATTAGGGTTAACAAATAAATTACATATTGGTTCATTAAATCAAGTAATTACCACCCATCACCCTGTACGTGTAGCAGAAGAAGCCAGTTTATTAGATCAAATGTCAGAGGGACGCTTCATTCTTGGTTTTAGTGACTGCGAAAGTGATTTCGAAATGGAATTTTTTAGACGTCATATCTCATCAAGGCAACAACAATTTGAAGCATGCTATGAAATAATTAATGACGCATTAACTACAGGTTATTGTCATCCCCAAAACGACTTTTATGATTTTCCAAAGGTTTCAATTAATCCACACTGTTACAGTGAGAATGGACCTAAGCAATATGTATCCGCTACATCAAAAGAAGTCGTCATGTGGGCAGCGAAAAAGGCACTGCCTTTAACATTTAAGTGGGAGGATAATTTAGAAACCAAAGAACGCTATGCAATTCTATATAATAAAACAGCACAACAATATGGTATTGATATTTCGGATGTTGATCATCAATTAACTGTAATTGCGAACTTAAATGCTGATAGAAGTACGGCTCAAGAAGAAGTGAGAGAATACTTAAAAGACTATATCACTGAAACTTACCCTCAAATGGACAGAGATGAAAAAATTAACTGCATTATTGAAGAGAATGCAGTTGGGTCTCATGATGACTATTATGAATCGACAAAATTAGCAGTGGAAAAAACAGGGTCTAAAAATATTTTATTATCCTTTGAATCAATGTCCGATATTAAAGATGTAAAAGATATTATTGATATGTTGAACCAAAAAATCGAAATGAATTTACCATAATAAAATTAAAGGCAATTTCTATATTAGATTGCCTTTTTAAATTTCTGTTGATATTAGGTATTACTGGAGAGGGTATGACTGTCCATACTGAATATAAAAGAAATCAAATCATTGCTAGTTCAGAAATTGATGATCTTATCTTTATGACGAAACCACAAGAGTGGTCATTTGAAGAGCAAAAAGAAATACGGGATAAATTAGTTCGTGAGGCTTTTTATTTTCACTACAATAGAAATGAAGAATATAGAAATTATTGTATCAATCAGCATGTGAGTGATAATTTACACACTATTGATGAAATACCCGTGTTTCCAACATCTGTTTTTAAATATAAGAAATTACATACTGTCACAGCCGAGGACATTGAAAATTGGTATACAAGTAGTGGAACTCGTGGAGTAAAAAGTCATATTGCACGTGATCGTCTTAGCATTGAACGCTTGCTTGGTTCTGTCAACTTCGGAATGAAATACGTTGGAGATTGGTTTGAGCATCAAATGGAATTGATAAATTTAGGACCAGATAGATTCAATACAAATAATATTTGGTTTAAATATGTCATGAGTTTGGTCGAGTTACTTTATCCGACTGAATTTACAGTTGATAATGACAAAATAGATTTTGAAAAAACAGTAAAACATCTATTTAGAATTAAGAATAGTAAAAAAGACATTTGCTTAATTGGGCCACCATTTTTTGTGTATCTTTTGTGCCAATATATGAAAGAAAACAATATTGAATTTAAAGGAGGAGATAGAGTACATATTATTACTGGTGGAGGATGGAAATCTAATCAGAATGACTCTTTAGATCGTGCTGATTTTAATCAATTATTAATGGATACTTTCCAACTCGACAAGATTAATCAAATTAGAGATACCTTTAATCAAGTTGAGCTTAATACTTGTTTTTTTGAAGATGAATTTCAAAGAAAACATGTTCCACCGTGGGTATATGCTCGGGCTCTTGATCCTGAAACCTTGAAACCCGTAGCAGATGGTGAGATCGGGTTGTTAAGTTATATGGACGCCTCATCAACTGCTTACCCTGCTTTTATTGTTACTGATGATATCGGTATTGTAAAAGAAATTAGAGAACCAGATCCTTACCCAGGGGTAACTGTTGAGATTGTTCGGCGCTTAAATACACGTGCGCAAAAAGGATGCGCGCTCTCTATGGCTAATGTCATACAAAAGAATATCAAGGATTAAGTTATGATTGTTGATGGTAGAGTTTCAAAAATAGTATTAGCGTCAATAAGAAATAATATATATAAGGTATTTATTACTGTAAATTCACCAATAAAGTTCATCGCTGGACAATTTGTAATGGTCACGATTAATGGGAAAAAATGCCCTTTTTCAATTGCGAATTGCCCGACAAAAAATTACGAAATAGAATTGCATATTGGTAGTTCGAATAGAGACTGCTCATTGGATATTATCGAATATTTTGTCGATGCTCTTGTTGAGGAAGTCGCAATTGAGTTAGATGCTCCCCATGGAAACGCTTGGTTACGGTCTGAAAGTAATAACCCATTGCTATTAATTGCGGGAGGTACAGGTTTATCATATATAAATAGCATTCTAACAAATTGCTTAAATAGGAATATACCTCAAGATATTTATCTTTACTGGGGAGTAAAAGACAGTTCTCTTTTGTATGAAGATGAAGAGTTACTAAACTTATCACTAAACAACAAAAACTTTCATTATATTCCTGTTATTGAAGATAAAAGTGAAGAATGGATAGGGAGAAAAGGCACTGTTCTTGATGCTGTCATGGAAGATTTTACTGATCTTACTTATTTTGATATTTATGTTTGTGGACCCTTCATGATGGCTAAAACAGCAAAAGAAAAATTAATTGAAGAGAAAAAAGCAAAGTCAGAACAGATGTTTGCCGATGCTTTTGCATACGTATAAAGAGAATATAAAAAGCCAGATTATTAATCCGGCTTTTTTATTATTTCAATGTGTCCAAGGGTAACCAAGTTACTTCAACTCCCGCCTGAGAGAACATATCTTGGCTCACTTGAATTTTTTCACCCCAACGAGATAAGAAGTCTTCAGTTTGTTCAGGGCAATATACTTTTGATATTCCTGTTTGGATGATTTTTGCTGCGCAGTTTGGACAAGGGAAGTGAGTAACCCAAATATCGCAACCTTCTAAATCACGCTTGGCAAATAAAATGGCATTTTCTTCAGCATGAAGTGTTTTTAAATATTTAATTTCACGTTCATCTGTATCTGCACTGTCTGATACACCATGTGGGTAGCCATTAAATCCAACAGAAACAATACGGTTATGCTTGGTGATTACTGCACCAACTTGAGTCGAC"
features_1=[
    GraphicFeature(start=216, end=968, strand=-1, color="gold"),
    GraphicFeature(start=974, end=981, strand=-1, color="tab:blue"),
    GraphicFeature(start=1005, end=1015, strand=0, color="tab:olive"),
    GraphicFeature(start=1011, end=1012, strand=-1, color="tab:grey"),
    GraphicFeature(start=1014, end=1019, strand=-1, color="tab:blue"),
    GraphicFeature(start=1041, end=1047, strand=-1, color="tab:blue"),
    GraphicFeature(start=1071, end=1077, strand=0, color="tab:olive"),
    GraphicFeature(start=1115, end=1135, strand=+1, color="tab:olive"),
    GraphicFeature(start=1154, end=1160, strand=+1, color="tab:blue"),
    GraphicFeature(start=1166, end=1167, strand=+1, color="tab:grey"),
    GraphicFeature(start=1174, end=1181, strand=+1, color="tab:blue"),  
    GraphicFeature(start=1187, end=1768, strand=+1, color="gold")  
]
sequence_2 ="TGCCACCTGACGTCTAAGAAACCATTATTATCATGACATTAACCTATAAAAATAGGCGTATCACGAGGCAGAATTTCAGATAAAAAAAATCCTTAGCTTTCGCTAAGGATGATTTCTGGAATTCGCGGCCGCTTCTAGAGACCTGTAGGATCGTACAGGTTTACGCAAGAAAATGGTTTGTTATAGTCGAATAAATACTAGAGAAAGAGGAGAAATACTAGATGGTGAGCAAGGGCGAGGAGCTGTTCACCGGGGTGGTGCCCATCCTGGTCGAGCTGGACGGCGACGTAAACGGCCACAAGTTCAGCGTGTCCGGCGAGGGCGAGGGCGATGCCACCTACGGCAAGCTGACCCTGAAGTTCATCTGCACCACCGGCAAGCTGCCCGTGCCCTGGCCCACCCTCGTGACCACCTTCGGCTACGGCCTGCAATGCTTCGCCCGCTACCCCGACCACATGAAGCTGCACGACTTCTTCAAGTCCGCCATGCCCGAAGGCTACGTCCAGGAGCGCACCATCTTCTTCAAGGACGACGGCAACTACAAGACCCGCGCCGAGGTGAAGTTCGAGGGCGACACCCTGGTGAACCGCATCGAGCTGAAGGGCATCGACTTCAAGGAGGACGGCAACATCCTGGGGCACAAGCTGGAGTACAACTACAACAGCCACAACGTCTATATCATGGCCGACAAGCAGAAGAACGGCATCAAGGTGAACTTCAAGATCCGCCACAACATCGAGGACGGCAGCGTGCAGCTCGCCGACCACTACCAGCAGAACACCCCCATCGGCGACGGCCCCGTGCTGCTGCCCGACAACCACTACCTGAGCTACCAGTCCGCCCTGAGCAAAGACCCCAACGAGAAGCGCGATCACATGGTCCTGCTGGAGTTCGTGACCGCCGCCGGGATCACTCTCGGCATGGACGAGCTGTACAAGTAATAATACTAGAGCCAGGCATCAAATAAAACGAAAGGCTCAGTCGAAAGACTGGGCCTTTCGTTTTATCTGTTGTTTGTCGGTGAACGCTCTCTACTAGAGTCACACTGGCTCACCTTCGGGTGGGCCTTTCTGCGTTTATATACTAGAGGCCCAACAGAAAAAGCCTCTCATTTAGAGCAGCTTATTCGTCAAGATTTCATGGAAATGTATGAGATCAATTTTCCACAAAAAACAGAGTAACAAAGAGAAAAACCTATAGGTATAAAGCTTTACTTACGTACTTAATTTTTAAAGTATGGGCAATCAATTGCTCCTGTTAAAATTGCTTTAGAAATACTTTGGCAGCGGTTTGTTGTATTGAGTTTCATTTGCGCATTGGTTAAATGGAAAGTGACAGTACGCTCACTGCAGCCTAATATTTTTGAAATATCCCAAGAGCTTTTTCCTTCGCATGCCCACGCTAAACATTCTTTTTCTCTTTTGGTTAAATCGTTGTTTGATTTATTATTTGCTATATTTATTTTTCGATAATTATCAACTAGAGAAGGAACAATTAATGGTATGTTCATACACGCATGTAAAAATAAACTATCTATATAGTTGTCTTTTTCTGAATGTGCAAAACTAAGCATTCCGAAGCCATTGTTAGCCGTATGAATAGGGAAACTAAACCCAGTGATAAGACCTGATGTTTTCGCTTCTTTAATTACATTTGGAGATTTTTTATTTACAGCATTGTTTTCAAATATATTCCAATTAATTGGTGAATGATTGGAGTTAGAATAATCTACTATAGGATCATATTTTATTAAATTAGCGTCATCATAATATTGCCTCCATTTTTTAGGGTAATTATCTAGAATTGAAATATCAGATTTAACCATAGAATGAGGATAAATGATCGCGAGTAAATAATATTCACAATGTACCATTTTAGTCATATCAGATAAGCATTGATTAATATCATTATTGCTTCTACAAGCTTTAATTTTATTAATTATTCTGTATGTGTCGTCGGCATTTATGTTTTTCATACCCATCTCTTTATCCTTACCTATTGTTTGTCGCAAGTTTTGCGTGTTATATATCATTAAAACGGTAATGGATTGACATTTGATTCTAATAAATTGGATTTTTGTCACACTATTGTATCGCTGGGAATACAATTACTTAACATAAGCACCTGTAGGATCGTACAGGTTTACGCAAGAAAATGGTTTGTTATAGTCGAATAAACGCAAGGGAGGTTGGTATGACTATAATGATAAAAAAATCGGATTTTTTGGCAATTCCATCGGAGGAGTATAAAGGTATTCTAAGTCTTCGTTATCAAGTGTTTAAGCAAAGACTTGAGTGGGACTTAGTTGTAGAAAATAACCTTGAATCAGATGAGTATGATAACTCAAATGCAGAATATATTTATGCTTGTGATGATACTGAAAATGTAAGTGGATGCTGGCGTTTATTACCTACAACAGGTGATTATATGCTGAAAAGTGTTTTTCCTGAATTGCTTGGTCAACAGAGTGCTCCCAAAGATCCTAATATAGTCGAATTAAGTCGTTTTGCTGTAGGTAAAAATAGCTCAAAGATAAATAACTCTGCTAGTGAAATTACAATGAAACTATTTGAAGCTATATATAAACACGCTGTTAGTCAAGGTATTACAGAATATGTAACAGTAACATCAACAGCAATAGAGCGATTTTTAAAGCGTATTAAAGTTCCTTGTCATCGTATTGGAGACAAAGAAATTCATGTATTAGGTGATACTAAATCGGTTGTATTGTCTATGCCTATTAATGAACAGTTTAAAAAAGCAGTCTTAAATGCTGCAAACGACGAAAACTACGCTTTAGTAGCTTAATAACTCTGATAGTGCTAGTGTAGATCTCTACTAGTAGCGGCCGCTGCAGTCCGGCAAAAAAGGGCAAGGTGTCACCACCCTGCCCTTTTTCTTTAAAACCGAAAAGATTACTTCGCGTTATGCAGGCTTCCTCGCTCACTGACTCGCTGCGCTCGGTCGTTCGGCTGCGGCGAGCGGTATCAGCTCACTCAAAGGCGGTAATGCTCACTCAAAGGCGGTAATACGGTTATCCACAGAATCAGGGGATAACGCAGGAAAGAACATGTGAGCAAAAGGCCAGCAAAAGGCCAGGAACCGTAAAAAGGCCGCGTTGCTGGCGTTTTTCCACAGGCTCCGCCCCCCTGACGAGCATCACAAAAATCGACGCTCAAGTCAGAGGTGGCGAAACCCGACAGGACTATAAAGATACCAGGCGTTTCCCCCTGGAAGCTCCCTCGTGCGCTCTCCTGTTCCGACCCTGCCGCTTACCGGATACCTGTCCGCCTTTCTCCCTTCGGGAAGCGTGGCGCTTTCTCATAGCTCACGCTGTAGGTATCTCAGTTCGGTGTAGGTCGTTCGCTCCAAGCTGGGCTGTGTGCACGAACCCCCCGTTCAGCCCGACCGCTGCGCCTTATCCGGTAACTATCGTCTTGAGTCCAACCCGGTAAGACACGACTTATCGCCACTGGCAGCAGCCACTGGTAACAGGATTAGCAGAGCGAGGTATGTAGGCGGTGCTACAGAGTTCTTGAAGTGGTGGCCTAACTACGGCTACACTAGAAGAACAGTATTTGGTATCTGCGCTCTGCTGAAGCCAGTTACCTTCGGAAAAAGAGTTGGTAGCTCTTGATCCGGCAAACAAACCACCGCTGGTAGCGGTGGTTTTTTTGTTTGCAAGCAGCAGATTACGCGCAGAAAAAAAGGATCTCAAGAAGATCCTTTGATCTTTTCTACGGGGTCTGACGCTCAGTGGAACGAAAACTCACGTTAAGGGATTTTGGTCATGAGATTATCAAAAAGGATCTTCACCTAGATCCTTTTAAATTAAAAATGAAGTTTTAAATCAATCTAAAGTATATATGAGTAAACTTGGTCTGACAGCTCGAGGCTTGGATTCTCACCAATAAAAAACGCCCGGCGGCAACCGAGCGTTCTGAACAAATCCAGATGGAGTTCTGAGGTCATTACTGGATCTATCAACAGGAGTCCAAGCGAGCTCGATATCAAATTACGCCCCGCCCTGCCACTCATCGCAGTACTGTTGTAATTCATTAAGCATTCTGCCGACATGGAAGCCATCACAAACGGCATGATGAACCTGAATCGCCAGCGGCATCAGCACCTTGTCGCCTTGCGTATAATATTTGCCCATGGTGAAAACGGGGGCGAAGAAGTTGTCCATATTGGCCACGTTTAAATCAAAACTGGTGAAACTCACCCAGGGATTGGCTGAGACGAAAAACATATTCTCAATAAACCCTTTAGGGAAATAGGCCAGGTTTTCACCGTAACACGCCACATCTTGCGAATATATGTGTAGAAACTGCCGGAAATCGTCGTGGTATTCACTCCAGAGCGATGAAAACGTTTCAGTTTGCTCATGGAAAACGGTGTAACAAGGGTGAACACTATCCCATATCACCAGCTCACCGTCTTTCATTGCCATACGAAATTCCGGATGAGCATTCATCAGGCGGGCAAGAATGTGAATAAAGGCCGGATAAAACTTGTGCTTATTTTTCTTTACGGTCTTTAAAAAGGCCGTAATATCCAGCTGAACGGTCTGGTTATAGGTACATTGAGCAACTGACTGAAATGCCTCAAAATGTTCTTTACGATGCCATTGGGATATATCAACGGTGGTATATCCAGTGATTTTTTTCTCCATTTTAGCTTCCTTAGCTCCTGAAAATCTCGATAACTCAAAAAATACGCCCGGTAGTGATCTTATTTCATTATGGTGAAAGTTGGAACCTCTTACGTGCCCGATCAACTCGAG"
features_2=[
    GraphicFeature(start=0, end=20, strand=+1, color="tab:grey"),
    GraphicFeature(start=77, end=117, strand=-1, color="tab:red"),
    GraphicFeature(start=140, end=195, strand=+1, color="tab:blue"),
    GraphicFeature(start=140, end=160, strand=+1, color="tab:olive"),
    GraphicFeature(start=182, end=187, strand=+1, color="tab:blue"),
    GraphicFeature(start=204, end=215, strand=+1, color="tab:blue"),
    GraphicFeature(start=222, end=944, strand=+1, color="tab:olive"),
    GraphicFeature(start=953, end=1081, strand=+1, color="tab:red"),
    GraphicFeature(start=1223, end=1975, strand=-1, color="tab:orange"),
    GraphicFeature(start=2021, end=2054, strand=-1, color="tab:blue"),
    GraphicFeature(start=2123, end=2177, strand=+1, color="tab:blue"),
    GraphicFeature(start=2194, end=2836, strand=+1, color="tab:orange"),
    GraphicFeature(start=2858, end=2915, strand=+1, color="tab:red"),
    GraphicFeature(start=3011, end=3030, strand=-1, color="tab:grey"),
]
#%%

record_1 = GraphicRecord(sequence=sequence_1, sequence_length=8654, features=features_1)
record_2 = GraphicRecord(sequence=sequence_2, sequence_length=4786, features=features_2)

m1 = record_1.crop((1110, 1190))
m2 = record_2.crop((139, 224))

fig, axs = plt.subplots(nrows=2, ncols=1, figsize=(6, 3))#, facecolor="None")

m1.plot(ax=axs[0])
m1.plot_sequence(ax=axs[0], fontdict={"fontsize":6})
m2.plot(ax=axs[1])
m2.plot_sequence(ax=axs[1], fontdict={"fontsize":6})

#axs[0].fill_between((1000, 1080), +2, -0.5, alpha=0.2, facecolor="tab:blue")
#axs[0].fill_between((1110, 1190), +2, -0.5, alpha=0.2, facecolor="tab:blue")
#axs[0].set_xticks(np.arange(960, 1201, 60))
#axs[1].set_xticks(np.arange(1000, 1081, 20))
axs[0].set_xticks(np.arange(1110, 1191, 20))
axs[1].set_xticks(np.arange(140, 224, 20))

axs[0].text(1, 0.5, "$\it{luxI}$", transform=axs[0].transAxes, fontsize=9, va='top', ha='right')
axs[1].text(0.82, 0.66, "synthetic\nRBS", transform=axs[1].transAxes, fontsize=9, va='top', ha='center')
axs[1].text(0.52, 0.75, "-10", transform=axs[1].transAxes, fontsize=9, va='top', ha='center')
axs[1].text(1, 0.5, "EYFP", transform=axs[1].transAxes, fontsize=9, va='top', ha='right')
axs[1].text(0.15, 0.75, "luxR binding site", transform=axs[1].transAxes, fontsize=9, va='top', ha='center')
#axs[2].text(1, 0.5, "$\it{luxI}$", transform=axs[2].transAxes, fontsize=9, va='top', ha='right')
axs[0].text(0.84, 0.5, "putative RBS", transform=axs[0].transAxes, fontsize=9, va='top', ha='center')
axs[0].text(0.7, 0.5, "TS", transform=axs[0].transAxes, fontsize=9, va='top', ha='center')
axs[0].text(0.58, 0.5, "-10", transform=axs[0].transAxes, fontsize=9, va='top', ha='center')
axs[0].text(0.18, 0.5, "luxR binding site", transform=axs[0].transAxes, fontsize=9, va='top', ha='center')
#axs[1].text(0.55, 0.5, "promoter\nregion", transform=axs[1].transAxes, fontsize=9, va='top', ha='center')
axs[0].text(0, 0.75, "(a)", transform=axs[0].transAxes, fontsize=9, va='center', ha='left')
axs[1].text(0, 0.75, "(b)", transform=axs[1].transAxes, fontsize=9, va='center', ha='left')
#axs[2].text(0, 0.75, "(c)", transform=axs[2].transAxes, fontsize=9, va='top', ha='left')
#%%
fig.tight_layout()
#fig.savefig('../figure/synthetic-promoter.pdf', bbox_inches='tight')
fig.savefig('../figure/thesis-synt-prom.png', dpi=300, bbox_inches='tight', transparent=True)